<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0046)http://kstore.qianmi.com/customer/comment.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--<base href="/">--><base href=".">
<title>商品评价-农产品</title>

<meta name="Keywords" content="欢迎来到一元中啦">
<meta name="description" content="商城系统">
<meta name="renderer" content="webkit">
	<link rel="Shortcut Icon" href="http://img01.ningpai.com/1432879652077.jpg">
<link href="CSS/pages.css" rel="stylesheet" />
    <script src="Scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
    var oStaraLi,oUl,oSpan,oP;
    var i = iScore = iStar = 0;
    function commentstar(obj){
        oStar = document.getElementById(obj);
        aLi = oStar.getElementsByTagName("li");
        oUl = oStar.getElementsByTagName("ul")[0];
        oSpan = oStar.getElementsByTagName("span")[1];
        oP = oStar.getElementsByTagName("p")[0];

        if(obj == 'star1'){
            var aMsg = [
                "很不满意|差得太离谱，与卖家描述的严重不符，非常不满",
                "不满意|部分有破损，与卖家描述的不符，不满意",
                "一般|质量一般，没有卖家描述的那么好",
                "满意|质量不错，与卖家描述的基本一致，还是挺满意的",
                "非常满意|质量非常好，与卖家描述的完全一致，非常满意"
            ]
        }else if(obj=='star2'){
            var aMsg = [
                "很不满意|卖家态度很差，还骂人、说脏话，简直不把顾客当回事",
                "不满意|卖家有点不耐烦，承诺的服务也兑现不了",
                "一般|卖家回复问题很慢，态度一般，谈不上沟通顺畅",
                "满意|卖家服务挺好的，沟通挺顺畅的，总体满意",
                "非常满意|卖家的服务太棒了，考虑非常周到，完全超出期望值"
            ]
        }else{
            var aMsg = [
                "很不满意|再三提醒下，卖家超过一天才发货，耽误我的时间",
                "不满意|卖家发货有点慢的，催了几次终于发货了",
                "一般|卖家发货速度一般，提醒后才发货的",
                "满意|卖家发货还算及时",
                "非常满意|卖家发货速度非常快"
            ]
        }

        for (i = 1; i <= aLi.length; i++)
        {
            aLi[i - 1].index = i;
            //鼠标移过显示分数
            aLi[i - 1].onmouseover = function ()
            {
                oStar = document.getElementById(obj);
                aLi = oStar.getElementsByTagName("li");
                oUl = oStar.getElementsByTagName("ul")[0];
                oSpan = oStar.getElementsByTagName("span")[1];
                oP = oStar.getElementsByTagName("p")[0];
                fnPoint(this.index,aLi);
                //浮动层显示
                oP.style.display = "block";
                //计算浮动层位置
                oP.style.left = oUl.offsetLeft + this.index * this.offsetWidth - 104 + "px";
                //匹配浮动层文字内容
                oP.innerHTML = "<em><b>" + this.index + "</b> 分 " + aMsg[this.index - 1].match(/(.+)\|/)[1] + "</em>" + aMsg[this.index - 1].match(/\|(.+)/)[1]
            };
            //鼠标离开后恢复上次评分
            aLi[i - 1].onmouseout = function ()
            {
                oStar = document.getElementById(obj);
                aLi = oStar.getElementsByTagName("li");
                oUl = oStar.getElementsByTagName("ul")[0];
                oSpan = oStar.getElementsByTagName("span")[1];
                oP = oStar.getElementsByTagName("p")[0];
                fnPoint();
                //关闭浮动层
                oP.style.display = "none"
            };
            //点击后进行评分处理
            aLi[i - 1].onclick = function ()
            {
                oStar = document.getElementById(obj);
                aLi = oStar.getElementsByTagName("li");
                oUl = oStar.getElementsByTagName("ul")[0];
                oSpan = oStar.getElementsByTagName("span")[1];
                oP = oStar.getElementsByTagName("p")[0];
                sinput =  oStar.getElementsByTagName("input")[0];
                iStar = this.index;
                oP.style.display = "none";
                oSpan.innerHTML = "<strong>" + (this.index) + " 分</strong> (" + aMsg[this.index - 1].match(/\|(.+)/)[1] + ")"
                sinput.value=this.index;
            }
        }

    }
    //评分处理
    function fnPoint(iArg)
    {
        //分数赋值
        iScore = iArg || iStar;
        for (i = 0; i < aLi.length; i++) aLi[i].className = i < iScore ? "on" : "";
    }


</script></head>

<body>
<link rel="stylesheet" href="http://kstore.qianmi.com/index_seven/css/style.css">
<input type="hidden" id="basePath" value="">
<div class="section_headerTop">
    <div class="slot slot_headerTop01">
        <ul class="siteNav right">
            <li><span>您好qm_18721718153，欢迎来到一元中啦</span></li>
            <input type="hidden" id="customer_id" value="2256">
            <li class="login_info">
            </li>
            <li class="loginout_info">
                <a class="site_loginout" href="http://kstore.qianmi.com/logout.html">退出</a>
            </li>
            <li class="nav_item navCenter">
                <a href="Index.html" target="_blank">会员中心<s></s></a>
                <div class="navInfo">
                    <a href="Order_MyOrder.html" target="_blank">我的订单</a>
                </div>
            </li>
            <li class="nav_item"><a href="javascript:;" onclick="addToFavorite('农产品');">加入收藏</a></li>
            <li class="nav_item"><a href="javascript:;" onclick="shareUrl();">分享给好友</a></li>
        </ul>
    </div>
    <div class="slot slot_headerTop02"></div>
</div>
<div class="bh-mask"></div>
<div id="ctDia" class="bh-dialog dia0">
    <div class="dia-tit">
        <h4>加入收藏</h4>
        <a class="dia-close" href="javascript:;" onclick="clss(this)"></a>
    </div>
    <div class="dia-cont">
        <p style="text-align: center;line-height:100px;">请使用菜单栏或Ctrl+D进行添加！</p>
    </div>
    <div class="dia-btn"><a href="javascript:;" onclick="clss(this)">确定</a></div>
</div>

<div id="ctDia" class="bh-dialog dia101">
    <div class="dia-tit">
        <h4>分享好友</h4>
        <a class="dia-close" href="javascript:;" onclick="clss(this)"></a>
    </div>
    <div class="dia-cont">
        <div class="dia_collect_intro tc pt30" style="text-align: center;padding-top: 30px;">
            <span id="content" style="font-size:16px"></span>
        </div>
        <div class="dia-btn" style="padding-top: 30px;">
            <a id="copy" data-clipboard-target="content" href="javascript:;">复制</a>
            <a onclick="clss(this)" href="javascript:;">取消</a>
            <br>
            <span style="color: red; font-size:12px">亲！如果您的好友成功注册为会员，会有积分送给您哦！</span>
        </div><!--/dia_ops-->
    </div><!--/dia_cont-->
</div><!--/dialog-->



<div id="ctDia" class="bh-dialog dia102">
    <div class="dia-tit">
        <h4>登录提示</h4>
        <a class="dia-close" href="javascript:;" onclick="clss(this)"></a>
    </div>
    <div class="dia-cont">
        <p style="text-align: center;line-height:100px;">您未登录！现在确认要登录吗？</p>
    </div>
    <div class="dia-btn">
        <a onclick="login()" href="javascript:;">确定</a>
        <a href="javascript:;" onclick="clss(this)">取消</a>
    </div>
</div><!--/dialog-->



<div id="ctDia" class="bh-dialog dia103">
    <div class="dia-tit">
        <h4>操作提示</h4>
        <a class="dia-close" href="javascript:;" onclick="clss(this)"></a>
    </div>
    <div class="dia-cont">
        <p style="text-align: center">复制成功！</p>
    </div>
    <div class="dia-btn"><a href="javascript:;" onclick="clss()">确定</a></div>

</div><!--/dialog-->
<div class="bh-mask"></div>
<script>
    function dias(n){
        $(".bh-mask").fadeIn();
        $(".dia"+n).fadeIn();
    };
    function clss(){
        $(".bh-dialog").fadeOut();
        $(".bh-mask").fadeOut();
    }
    //分享链接给好友 弹出层
    function shareUrl(){
        var basePath = $('#basePath').val();
        var str = window.location.href;
        var b = str.indexOf('/',str.indexOf('/')+2);
//		var a = str.indexOf("//")+2;
        var local = str.substring(0,b);
        var customerId = $('#customer_id').val(); //当前登录的用户ID
        if(customerId==null||customerId==""){
            dias(102);
        }else{
            //给会员id加密
            var b = new Base64();
            var result = 'customer_id='+customerId;
            var str = b.encode('"'+result+'"');
            var url = local+basePath+'/register.html?'+str;
            $('#content').html(url);
            dias(101);
        }
        //复制成功弹出复制成功窗口
        $('#copy').zclip({
            path:'/js/ZeroClipboard.swf',
            copy:function(){
                return $("#content").html();
            },
            afterCopy:function(){
                dias(103);
            }
        });
    }

    //推荐该网站给好友- 登录
    function login(){
        var basePath = $('#basePath').val();
        //获取页面登录的 href
        window.location.href=basePath+'/login.html';

    }

    //对会员ID进行加密
    function Base64() {
        _keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
        this.encode = function (input) {
            var output = "";
            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
            var i = 0;
            input = _utf8_encode(input);
            while (i < input.length) {
                chr1 = input.charCodeAt(i++);
                chr2 = input.charCodeAt(i++);
                chr3 = input.charCodeAt(i++);
                enc1 = chr1 >> 2;
                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                enc4 = chr3 & 63;
                if (isNaN(chr2)) {
                    enc3 = enc4 = 64;
                } else if (isNaN(chr3)) {
                    enc4 = 64;
                }
                output = output +
                _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +
                _keyStr.charAt(enc3) + _keyStr.charAt(enc4);
            }
            return output;
        }

        // public method for decoding
        this.decode = function (input) {
            var output = "";
            var chr1, chr2, chr3;
            var enc1, enc2, enc3, enc4;
            var i = 0;
            input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
            while (i < input.length) {
                enc1 = _keyStr.indexOf(input.charAt(i++));
                enc2 = _keyStr.indexOf(input.charAt(i++));
                enc3 = _keyStr.indexOf(input.charAt(i++));
                enc4 = _keyStr.indexOf(input.charAt(i++));
                chr1 = (enc1 << 2) | (enc2 >> 4);
                chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
                chr3 = ((enc3 & 3) << 6) | enc4;
                output = output + String.fromCharCode(chr1);
                if (enc3 != 64) {
                    output = output + String.fromCharCode(chr2);
                }
                if (enc4 != 64) {
                    output = output + String.fromCharCode(chr3);
                }
            }
            output = _utf8_decode(output);
            return output;
        }

        // private method for UTF-8 encoding
        _utf8_encode = function (string) {
            string = string.replace(/\r\n/g, "\n");
            var utftext = "";
            for (var n = 0; n < string.length; n++) {
                var c = string.charCodeAt(n);
                if (c < 128) {
                    utftext += String.fromCharCode(c);
                } else if ((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                } else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }

            }
            return utftext;
        }

        // private method for UTF-8 decoding
        _utf8_decode = function (utftext) {
            var string = "";
            var i = 0;
            var c = c1 = c2 = 0;
            while (i < utftext.length) {
                c = utftext.charCodeAt(i);
                if (c < 128) {
                    string += String.fromCharCode(c);
                    i++;
                } else if ((c > 191) && (c < 224)) {
                    c2 = utftext.charCodeAt(i + 1);
                    string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                    i += 2;
                } else {
                    c2 = utftext.charCodeAt(i + 1);
                    c3 = utftext.charCodeAt(i + 2);
                    string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                    i += 3;
                }
            }
            return string;
        }
    }
</script>
<script src="Scripts/jquery.zclip.min.js"></script>
<script src="Scripts/jquery.zclip.js"></script>
    <script src="Scripts/Custom/PersonMenus.js"></script>
        <div class="n_head">

        </div>

        <input type="hidden" id="currentProvince" value="">
        <input type="hidden" id="basePath" value="">
        <script src="Scripts/minShopping.js"></script>

<input type="hidden" value="f37f95bda11ddc47c03dbf66c74a4940" id="hi_token">

<div style="background: #f5f5f5;">
    <div class="container clearfix pt20 pb10">
        <!--new_member_left-->
<div class="new_member_left">

</div>
<!--new_member_left-->        <div class="new_member-right">
            <div class="air-info-judge">
                <div class="n-title">商品评价</div>
                <div class="content">
                    <div class="layout" id="No0">
                        <table class="air-judge-table mt10">
                            <thead>
                            <tr>
                                <th width="480">商品信息</th>
                                <th>购买时间</th>
                                <th>操作</th>
                            </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="3" style="text-align:center; height:60px;font-size: 18px;">暂无商品评价！</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="paging_area">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="mask"></div>
<div class="member-dialog dia2" style="top: 299.5px; left: 571.5px;">
    <div class="member-dialog-body">
        <div class="title"><a href="javascript:;" onclick="cls()">×</a>提示</div>
        <div class="tc">
            <div class="que-delete clearfix">
                <img  src="Images/images_l6.png">
                <div class="fl tl">
                    <p class="f16 red" id="errorT2">请先选择要删除的图片！</p>
                    <div class="m-btn mt20">
                        <a id="go_pay_01" href="javascript:;cls();">确定</a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<div class="member-dialog dia3" style="top: 299.5px; left: 571.5px;">
    <div class="member-dialog-body">
        <div class="title"><a href="javascript:;" onclick="cls()">×</a>提示</div>
        <div class="tc">
            <div class="que-delete clearfix">
                <img  src="Images/images_l6.png">
                <div class="fl tl">
                    <p class="f16 red" id="errorT">请先选择要删除的图片！</p>
                    <div class="m-btn mt20">
                        <a id="go_pay_01" href="javascript:;cls();">确定</a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="member-dialog dia4" style="top: 299.5px; left: 571.5px;">
    <div class="member-dialog-body">
        <div class="title"><a href="javascript:;" onclick="cls()">×</a>提示</div>
        <div class="tc">
            <div class="que-delete clearfix">
                <img  src="Images/images_l6.png">
                <div class="fl tl">
                    <p class="f16 red" id="titleerr">头像上传成功！</p>

                    <div class="m-btn mt20">
                        <a id="go_pay_00" href="javascript:cls();">确定</a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<input type="hidden" id="commentId">

	<link href="CSS/footer.css" rel="stylesheet" />
    <style>
        .mt20 {
            margin-top: 20px;
        }
    </style>
    <div style="background-color: #fff;">
    <div class="wp">

    </div><!--/wp-->
    </div><script src="Scripts/default.js"></script>
<script src="Scripts/jcarousellite_1.0.1.js"></script>
<script src="Scripts/tab-switch.js"></script>
<script src="Scripts/member.js"></script>
<script src="Scripts/customer_share.js"></script>
<script src="Scripts/newapp.js"></script>
<script src="Scripts/findcode.js"></script>
<script src="Scripts/jsOperation.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $(function(){
            $('.air-judge-table .bask').click(function(){
                $('.air-judgeBox').hide();
                var $judgeBox=$(this).parents('.air-judge-bd').find('.air-judgeBox')
                if($judgeBox.css('display')=='none'){
                    $judgeBox.show(200);
                }else{
                    $judgeBox.hide(200);
                }
            });
        });
        $('.item_title').each(function(){
            $(this).click(function(){
                $(this).next().toggle('fast',function(){
                    if($(this).is(':visible')){
                        $(this).prev().removeClass('up');
                        $(this).prev().addClass('down');
                    }
                    else{
                        $(this).prev().removeClass('down');
                        $(this).prev().addClass('up');
                    }
                });
            });
        });
        $(".new_member_left div:eq(4) ul li:eq(0)").addClass("cur");
        $(".pro_sort").addClass("pro_sort_close");
    });

    //发表评价晒单
    function addShare(orderGoodsId,goodInfoId){
        var tUrl = "/loadgoodstag.htm?CSRFToken="+$("#hi_token").val()+"&goodsId="+goodInfoId;
        $.ajax({
            type : 'post',
            url : tUrl,
            async : false,
            success : function(data) {
                var s = "";
                for(var i = 0;i< data.length;i++){
                    s+='<li onclick="selectedTag(this)" title="'+data[i].goodsTag.tagName+'">'+data[i].goodsTag.tagName+'</li>';
                }
                $("#g_tag"+orderGoodsId).html('');
                if(s.trim().length == 0 ){
                    $("#g_tag"+orderGoodsId).append("&nbsp;");
                }else{
                    $("#g_tag"+orderGoodsId).append(s);
                }
                $("#commentId").val(null);

            }
        });
    }
    //标签选中
    function selectedTag(tag){
    $(tag).siblings().removeClass("tags1");
        $(tag).addClass("tags1");
    }
//查看评论晒单
    function showShare(orderGoodsId){
        $.ajax({
            type : 'post',
            url : "/findCommentShare.htm?orderGoodsId="+orderGoodsId+"&CSRFToken="+$("#hi_token").val(),
            async : false,
            success : function(data) {
                //设置评分
               var score= $("#star"+orderGoodsId).find("li");
                for(var i=0;i<score.length;i++){
                    $(score[i]).removeClass("on");
                    if(i<data.commentScore){
                        $(score[i]).addClass("on");
                    }
                }
                //设置评价标签
                $("#tag"+orderGoodsId).find("li").remove();
                if(data.commentTag!=null){
                    $("#tag"+orderGoodsId).append("<li>"+data.commentTag+"</li>");
                }
                //设置评价内容
                $("#content"+orderGoodsId).html(data.commentContent);
                $("#commentId").val(data.commentId);
                //晒单图片
                var imgs=data.imageList;
                if(imgs !=null &&imgs.length>0){
                    var imgStr="";
                    for(var i=0;i<imgs.length;i++){
                        imgStr=imgStr+"<li><img src='"+imgs[i].imageName+"' alt=''/></li>"
                    }
                    $("#imgList"+orderGoodsId).find("li").remove();
                    $("#imgList"+orderGoodsId).append(imgStr);
                }

            }
        });
    }

    //判断评论内容字数是否过多
    function check(){
        if($("textarea[name=commentContent]").val().trim().length>500){
            $("#errorT2").html("评论内容字数过多!");
            $("#errorT2").append("<p>字数在10-500之间！</p>");
            dia(2);
            $(".subComm").attr("disabled","disabled");
            return false;
        }
        $(".subComm").removeAttr("disabled");
    }

    //评论默认文本
    var _txa = "注：(发表的评论内容请保持在500字以内)";
    //将所有评论心得textarea默认文本
    function fill(){
        if($(".c_text").val() == "") {
            $(".c_text").val(_txa).css("color","#999");
        };
    };
    fill();
    //评论心得onblur事件
    function blurFun(obj){
        if(obj.val() == "") {
            obj.val(_txa).css("color","#999");
        };
    }
    //评论心得onfucus事件
    function focusFun(obj){
        if(obj.val() == _txa) {
            obj.val("").css("color","#666");
        };
    }


</script>

</body></html>